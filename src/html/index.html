<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png" />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/apple-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/android-icon-192x192.png"
    />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />

    <style>
      .dtpcnt {
        opacity: 0;
      }
    </style>

    <script src="https://lander-main-microservice.netlify.app/scripts.js"></script>
    <!-- <script src="https://illustrious-squirrel-bec40c.netlify.app/scripts.js"></script> -->
    <script
      src="//geoip-js.com/js/apis/geoip2/v2.1/geoip2.js"
      type="text/javascript"
    ></script>

    <script>
      const queryString = window.location.search;
      const params = new URLSearchParams(queryString);
      const paramEntries = params.entries();
      const queryParams = [];
      for (const [key, value] of paramEntries) {
        queryParams.push(`${key}: ${value}`);
      }
      const domain = window.location.origin.replace("lander.", "");
      console.log(domain);

      if (domain.length === 0) {
        window.location.href = domain;
      }

      if (
        params.getAll("utm_campaign").includes("{{campaign.id}}") ||
        params.getAll("utm_campaign").includes("{campaignid}") ||
        params.getAll("utm_adset").includes("{adgroupid}") ||
        params.getAll("utm_adset").includes("{{adset.id}}") ||
        params.get("utm_campaign") === "{{campaign.id}}" ||
        params.get("utm_adset") === "{{adset.id}}" ||
        !params.get("utm_adset") ||
        params.get("utm_adset").length === 0 ||
        !params.get("utm_campaign") ||
        params.get("utm_campaign").length === 0
      ) {
        window.location.href = domain;
      }
      
      if(isNaN(Number(params.get("utm_campaign"))) || params.get("utm_campaign").length < 5){
        window.location.href = domain;
      }
      if(isNaN(Number(params.get("utm_adset"))) || params.get("utm_adset").length < 5){
        window.location.href = domain;
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <div id="noscripts"></div>
  </body>

  <script>
    const initNoScripts = ({ volum, gtm, fb, tikTok }) => {
      const element = window.document.getElementById("noscripts");
      element.innerHTML = `
      <noscript>
        <link
          href="${volum}"
          rel="stylesheet"
        />
      </noscript>
      `;

      element.innerHTML = `
      <noscript
        ><iframe
          src="https://www.googletagmanager.com/ns.html?id=${gtm}"
          height="0"
          width="0"
          style="display: none; visibility: hidden"
        ></iframe
      ></noscript>
      `;
      element.innerHTML = `
      <noscript
      ><img
        height="1"
        width="1"
        style="display: none"
        src="https://www.facebook.com/tr?id=${fb}&ev=PageView&noscript=1"
      /></noscript>
      `;
    };
    initNoScripts({
      volum: window.domain_settings.volum.noScript,
      gtm: window.domain_settings.gtm,
      fb: window.domain_settings.facebookPixel,
      tikTok: window.domain_settings.tikTok,
    });
  </script>
</html>
